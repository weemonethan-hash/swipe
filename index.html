<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scroll for Money üí∏</title>
<style>
  html,body{margin:0;height:100%;overflow:hidden;font-family:Poppins,sans-serif;color:white;}
  body{background:linear-gradient(0deg,#ff66cc,#66ccff,#99ff66,#ff9966);background-size:100% 1000%;transition:background-position .1s linear;}
  #world{position:absolute;width:100%;height:100%;transition:transform .1s linear;}
  #hud{position:fixed;top:10px;left:10px;background:rgba(20,20,20,.8);border:2px solid #00ff88;border-radius:12px;padding:10px 15px;z-index:1000;box-shadow:0 0 15px #00ff88;}
  #money{font-size:1.6em;color:#00ff88;text-shadow:0 0 10px #00ff88;font-weight:bold;}
  #xpBar{height:10px;width:100%;background:rgba(255,255,255,.2);border-radius:5px;margin-top:4px;overflow:hidden;}
  #xpFill{height:100%;width:0%;background:linear-gradient(90deg,#00ff88,#00ccff);transition:width .2s;}
  button{display:block;margin-top:6px;padding:6px 12px;background:#00ff88;color:#111;border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:.2s;}
  button:hover{transform:scale(1.05);background:#00cc6a;}
  .money-block{position:absolute;font-size:50px;border:3px solid white;border-radius:10px;padding:5px 10px;cursor:pointer;transition:transform .2s;user-select:none;}
  .fake{border-color:red;}
  .money-block:hover{transform:scale(1.2);}
  .float{position:absolute;color:#00ff88;font-weight:bold;pointer-events:none;animation:float 1s ease-out forwards;text-shadow:0 0 10px #00ff88;}
  @keyframes float{to{transform:translateY(-50px);opacity:0;}}
  /* Login screen */
  #authScreen{position:fixed;top:0;left:0;width:100%;height:100%;background:#111;color:white;display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:2000;}
  #authScreen input{margin:5px;padding:8px;border-radius:6px;border:none;width:200px;}
  #authMsg{color:red;margin-top:5px;}
  #gameScreen{display:none; flex-direction:column;}
</style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="authScreen">
  <h1>Login / Sign Up</h1>
  <input type="email" id="email" placeholder="Email"><br>
  <input type="password" id="password" placeholder="Password"><br>
  <button id="loginBtn">Login</button>
  <button id="signupBtn">Sign Up</button>
  <button id="logoutBtn" style="display:none;">Logout</button>
  <div id="authMsg"></div>
</div>

<!-- GAME SCREEN -->
<div id="gameScreen">
  <div id="hud">
    üí∞ <span id="money">0</span><br>
    ‚≠ê Level: <span id="level">1</span>
    <div id="xpBar"><div id="xpFill"></div></div>
    <div>‚¨ÜÔ∏è Scroll: <span id="scrollIncome">1</span></div>
    <div>üß± Block: <span id="blockValue">10</span></div>
    <button id="upB">Upgrade Block üíé (100)</button>
    <button id="upS">Upgrade Scroll üöÄ (150)</button>
    <button id="autoScrollBtn">üåÄ Auto Scroll: OFF</button>
    <button id="logoutBtn2">Logout</button>
  </div>
  <div id="world"></div>
  <audio id="ding" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDj5-jNLG4Ampuc56ygFA8kXScbuVFctBk",
    authDomain: "scroll-3f622.firebaseapp.com",
    projectId: "scroll-3f622",
    storageBucket: "scroll-3f622.firebasestorage.app",
    messagingSenderId: "1012742622451",
    appId: "1:1012742622451:web:e217b4a775975911d93b86"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const emailInput = document.getElementById("email");
  const passInput = document.getElementById("password");
  const authMsg = document.getElementById("authMsg");
  const authScreen = document.getElementById("authScreen");
  const gameScreen = document.getElementById("gameScreen");

  const logoutBtns = [document.getElementById("logoutBtn"), document.getElementById("logoutBtn2")];

  // GAME VARIABLES
  let money=0, blockScroll=1, block=10, level=1, xp=0;
  let upBC=100, upSC=150, worldY=0, bgY=0, auto=false;

  const world=document.getElementById("world"), ding=document.getElementById("ding");
  const mD=document.getElementById("money"), lD=document.getElementById("level"),
        sD=document.getElementById("scrollIncome"), bD=document.getElementById("blockValue"), xpF=document.getElementById("xpFill");
  const autoBtn=document.getElementById("autoScrollBtn");

  function xpNeed(){return 100*Math.pow(1.6,level-1);}
  function upd(){mD.textContent=Math.floor(money);lD.textContent=level;sD.textContent=blockScroll;bD.textContent=block;xpF.style.width=(xp/xpNeed()*100)+"%";}
  function sound(){ding.currentTime=0;ding.play().catch(()=>{});}
  function float(x,y,t,color="#00ff88"){let f=document.createElement("div");f.className="float";f.style.left=x+"px";f.style.top=y+"px";f.style.color=color;f.textContent=t;document.body.appendChild(f);setTimeout(()=>f.remove(),1000);}
  function addXP(a){xp+=a;if(xp>=xpNeed()){xp-=xpNeed();level++;sound();}}

  function spawnBlock(){
    const b=document.createElement("div");b.className="money-block";
    const fake=Math.random()<0.25;
    if(fake)b.classList.add("fake");
    b.textContent="üí∞";
    b.style.top=worldY+Math.random()*innerHeight-innerHeight/2+"px";
    b.style.left=Math.random()*(innerWidth-100)+"px";
    world.appendChild(b);
    b.onclick=e=>{
      if(fake){
        const loss=Math.ceil(level*0.5);
        level=Math.max(1,level-loss);
        xp=0;
        float(e.clientX,e.clientY,`-${loss} LVL`,"red");
        b.remove();
      }else{
        money+=block;
        float(e.clientX,e.clientY,"+"+block);
        sound();
        b.remove();
      }
      upd();
    };
    setTimeout(()=>b.remove(),8000);
  }

  // Upgrades
  document.getElementById("upB").onclick=()=>{if(money>=upBC){money-=upBC;block=Math.round(block*1.7);upBC=Math.round(upBC*2.2);event.target.textContent=`Upgrade Block üíé (${upBC})`;sound();upd();saveGame();}};
  document.getElementById("upS").onclick=()=>{if(money>=upSC){money-=upSC;blockScroll=Math.round(blockScroll*1.8);upSC=Math.round(upSC*2.4);event.target.textContent=`Upgrade Scroll üöÄ (${upSC})`;sound();upd();saveGame();}};

  autoBtn.onclick=()=>{auto=!auto;autoBtn.textContent=auto?"üåÄ Auto Scroll: ON":"üåÄ Auto Scroll: OFF";};

  window.addEventListener("wheel",e=>{
    const delta=e.deltaY;
    worldY+=delta*0.5;bgY+=delta*0.5;
    world.style.transform=`translateY(${-worldY}px)`;document.body.style.backgroundPosition=`0px ${bgY}px`;
    if(delta>0){
      const earn=delta*blockScroll*0.05;
      money+=earn;
      addXP(delta*0.02);
      if(Math.random()<0.06)spawnBlock();
      upd();
      saveGame();
    }
  });

  setInterval(()=>{if(auto){const delta=8;worldY+=delta*0.5;bgY+=delta*0.5;world.style.transform=`translateY(${-worldY}px)`;document.body.style.backgroundPosition=`0px ${bgY}px`;const earn=delta*blockScroll*0.05*0.12;money+=earn;if(Math.random()<0.03)spawnBlock();upd();saveGame();}},100);

  upd();

  // SAVE/LOAD GAME
  async function saveGame(){
    if(!auth.currentUser) return;
    await setDoc(doc(db,"users",auth.currentUser.uid),{money,blockScroll,block,level,xp});
  }

  async function loadGame(){
    if(!auth.currentUser) return;
    const snap = await getDoc(doc(db,"users",auth.currentUser.uid));
    if(snap.exists()){
      ({money,blockScroll,block,level,xp}=snap.data());
      upd();
    }
  }

  // LOGIN/SIGNUP/LOGOUT
  document.getElementById("loginBtn").onclick = async e=>{
    e.preventDefault();
    try{
      await signInWithEmailAndPassword(auth,emailInput.value,passInput.value);
      authMsg.textContent="";
    }catch(err){authMsg.textContent=err.message;}
  };

  document.getElementById("signupBtn").onclick = async e=>{
    e.preventDefault();
    try{
      await createUserWithEmailAndPassword(auth,emailInput.value,passInput.value);
      authMsg.textContent="";
    }catch(err){authMsg.textContent=err.message;}
  };

  logoutBtns.forEach(b=>b.onclick=()=>signOut(auth));

  onAuthStateChanged(auth, async user=>{
    if(user){
      authScreen.style.display="none";
      gameScreen.style.display="flex";
      await loadGame();
    } else {
      authScreen.style.display="flex";
      gameScreen.style.display="none";
    }
  });
</script>
</body>
</html>
