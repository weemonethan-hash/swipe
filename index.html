<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Scroll for Money â€” Online</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600;800&display=swap" rel="stylesheet">
<style>
:root{
--accent:#00ff88; --bg1:linear-gradient(0deg,#ff66cc,#66ccff,#99ff66,#ff9966);
--glass: rgba(12,12,16,.6);
--glass-2: rgba(255,255,255,.06);
}
html,body{height:100%;margin:0;font-family:Poppins,system-ui,Segoe UI,Roboto,Helvetica,Arial;color:#fff;overflow:hidden}
body{background:var(--bg1);background-size:100% 1400%;transition:background-position .12s linear}
#world{position:absolute;inset:0;overflow:hidden;transform:translateZ(0);pointer-events:none}
.money-block{position:absolute;pointer-events:auto;font-size:42px;padding:8px 12px;border-radius:10px;border:3px solid rgba(255,255,255,.12);background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));cursor:pointer;user-select:none;transition:transform .12s,opacity .2s}
.money-block:hover{transform:scale(1.15)}
#hud{
position:fixed;left:12px;top:12px;width:300px;background:var(--glass);border-radius:12px;padding:12px;backdrop-filter: blur(6px);
box-shadow:0 6px 24px rgba(0,0,0,.5);z-index:1000;border:1px solid rgba(255,255,255,.06)
}
#hud h1{margin:0;font-size:18px;letter-spacing:.6px}
.stat{display:flex;justify-content:space-between;padding:6px 0;font-weight:600}
#xpBar{height:10px;background:rgba(255,255,255,.08);border-radius:10px;overflow:hidden;margin-top:6px}
#xpFill{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),#00ccff);transition:width .2s}
button,input,select{font-family:inherit}
button{background:var(--accent);color:#021;border:none;padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:700;margin-top:8px}
button.ghost{background:transparent;border:1px solid rgba(255,255,255,.08);color:#fff}
#loginScreen{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:2500}
.card{width:360px;padding:18px;border-radius:14px;background:rgba(2,6,12,.9);box-shadow:0 10px 40px rgba(0,0,0,.6);border:1px solid rgba(255,255,255,.04)}
.card input{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid rgba(255,255,255,.06);background:transparent;color:#fff}
#topPlayers{margin-top:12px;font-size:14px}
#controls{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
#centerHUD{position:fixed;right:12px;top:12px;width:320px;background:var(--glass);padding:12px;border-radius:12px;z-index:1000;border:1px solid rgba(255,255,255,.04)}
.small{font-size:13px;opacity:.9}
.float{position:fixed;font-weight:800;pointer-events:none;opacity:1;transform:translateY(0);animation:floatUp .9s ease-out forwards;text-shadow:0 0 12px rgba(0,255,136,.6)}
@keyframes floatUp{to{transform:translateY(-50px);opacity:0}}
.badge{display:inline-block;padding:4px 8px;border-radius:999px;background:rgba(255,255,255,.03);font-weight:700}
.eventBanner{position:fixed;left:50%;transform:translateX(-50%);top:82px;background:linear-gradient(90deg,#ffd54d,#ff8a65);padding:8px 14px;border-radius:999px;color:#111;font-weight:900;z-index:1500;box-shadow:0 8px 30px rgba(0,0,0,.4)}
#leaderboard{margin-top:10px;background:var(--glass-2);padding:8px;border-radius:8px;max-height:170px;overflow:auto}
.row{display:flex;justify-content:space-between;padding:6px 8px;border-bottom:1px dashed rgba(255,255,255,.03)}
.smallButton{padding:6px 8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,.06);cursor:pointer;color:#fff}
@media (max-width:700px){
#hud{width:92%;left:4%;top:8px}
#centerHUD{display:none}
}
</style>
</head>
<body>

<div id="loginScreen">
  <div class="card">
    <h1>Scroll for Money â€” Login / Register</h1>
    <input id="email" placeholder="Email" type="email" />
    <input id="password" placeholder="Password" type="password" />
    <div style="display:flex;gap:8px;margin-top:8px">
      <button id="loginBtn">Login</button>
      <button id="registerBtn" class="ghost">Register</button>
      <button id="guestBtn" class="ghost">Play Guest</button>
    </div>
    <div id="loginMsg" class="small" style="margin-top:8px;color:#ffa">Tip: use any email + password</div>
    <div id="topPlayers" class="small"></div>
  </div>
</div>

<div id="hud" style="display:none">
  <h1>ðŸ’¸ Scroll for Money</h1>
  <div class="stat"><span>Money</span><span id="money">0</span></div>
  <div class="stat"><span>Level</span><span id="level">1</span></div>
  <div id="xpBar"><div id="xpFill"></div></div>
  <div class="stat small"><span>Scroll Income</span><span id="scrollIncome">1</span></div>
  <div class="stat small"><span>Block Value</span><span id="blockValue">10</span></div>

  <div id="controls">
    <button id="upBlock">Upgrade Block (100)</button>
    <button id="upScroll" class="ghost">Upgrade Scroll (150)</button>
    <button id="autoScrollBtn" class="ghost">Auto: OFF</button>
    <button id="prestigeBtn" class="ghost">Rebirth (Prestige)</button>
    <button id="dailyBtn" class="ghost">Daily Bonus</button>
    <button id="logoutBtn" class="ghost">Logout</button>
  </div>

  <div id="skins" style="margin-top:8px" class="small">
    Skins:
    <button id="bgSkin1" class="smallButton">Default</button>
    <button id="bgSkin2" class="smallButton">Neon (Lvl4)</button>
  </div>

  <div id="saveStatus" class="small" style="margin-top:8px;opacity:.8">Saved</div>
</div>

<div id="centerHUD" style="display:none">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <div><strong id="displayName">Player</strong><div class="small" id="emailLabel"></div></div>
    <div><span class="badge" id="prestigeMult">x1</span></div>
  </div>

  <div id="leaderboard">
    <div style="font-weight:800;margin-bottom:6px">Leaderboard</div>
    <div id="leadersList" class="small"></div>
    <div style="margin-top:6px"><button id="updateProfile" class="smallButton">Set Display Name</button></div>
  </div>

  <div style="margin-top:12px" class="small">
    Events: <span id="eventStatus">none</span>
  </div>
</div>

<div id="world"></div>
<audio id="ding" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>
<audio id="cash" src="https://assets.mixkit.co/sfx/preview/mixkit-epic-cash-register-443.mp3"></audio>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc, collection, query, orderBy, limit, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore.js";

const firebaseConfig = { apiKey:"AIzaSyDj5-jNLG4Ampuc56ygFA8kXScbuVFctBk", authDomain:"scroll-3f622.firebaseapp.com", projectId:"scroll-3f622", storageBucket:"scroll-3f622.firebasestorage.app", messagingSenderId:"1012742622451", appId:"1:1012742622451:web:e217b4a775975911d93b86" };
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const loginScreen = document.getElementById('loginScreen');
const hud = document.getElementById('hud');
const centerHUD = document.getElementById('centerHUD');
const world = document.getElementById('world');
const moneyEl = document.getElementById('money');
const levelEl = document.getElementById('level');
const xpFill = document.getElementById('xpFill');
const scrollIncomeEl = document.getElementById('scrollIncome');
const blockValueEl = document.getElementById('blockValue');
const prestigeMultEl = document.getElementById('prestigeMult');
const saveStatus = document.getElementById('saveStatus');

const emailI = document.getElementById('email'), passI = document.getElementById('password');
const loginBtn = document.getElementById('loginBtn'), registerBtn = document.getElementById('registerBtn'), guestBtn = document.getElementById('guestBtn');
const upBlock = document.getElementById('upBlock'), upScroll = document.getElementById('upScroll'), autoBtn = document.getElementById('autoScrollBtn');
const prestigeBtn = document.getElementById('prestigeBtn'), dailyBtn = document.getElementById('dailyBtn'), logoutBtn = document.getElementById('logoutBtn');
const bgSkin1 = document.getElementById('bgSkin1'), bgSkin2 = document.getElementById('bgSkin2');
const updateProfileBtn = document.getElementById('updateProfile');
const ding = document.getElementById('ding'), cash = document.getElementById('cash');

// ---------- state ----------
let money=0, block=10, blockScroll=1, level=1, xp=0;
let upBC=100, upSC=150, moneyMult=1, upMC=1_000_000;
let worldY=0, bgY=0, auto=false;
let currentBG='bg1', currentBlock='block1';
let prestigePoints=0, prestigeMultiplier=1;
let userId=null, userEmail='', displayName='Player';
let lastSave=Date.now();

// ---------- helpers ----------
function xpNeed(){ return Math.round(100*Math.pow(1.6,level-1)); }
function formatNum(n){
  if(n<1e3) return n;
  if(n<1e6) return (n/1e3).toFixed(1)+'K';
  if(n<1e9) return (n/1e6).toFixed(1)+'M';
  if(n<1e12) return (n/1e9).toFixed(1)+'B';
  return (n/1e12).toFixed(1)+'T';
}

function updateUI(){
  moneyEl.textContent='Â£'+formatNum(Math.floor(money));
  levelEl.textContent=level;
  xpFill.style.width=Math.min(100,xp/xpNeed()*100)+'%';
  scrollIncomeEl.textContent=blockScroll*moneyMult;
  blockValueEl.textContent=block;
  upBlock.textContent=`Upgrade Block (${formatNum(upBC)})`;
  upScroll.textContent=`Upgrade Scroll (${formatNum(upSC)})`;
  prestigeMultEl.textContent='x'+prestigeMultiplier.toFixed(2);
  saveStatus.textContent=(Date.now()-lastSave<5000)?'Saved':'Saving...';
}

function playSound(node){ try{ node.currentTime=0; node.play(); }catch(e){} }
function floatText(x,y,t,color='var(--accent)'){ const el=document.createElement('div'); el.className='float'; el.style.left=x+'px'; el.style.top=y+'px'; el.style.color=color; el.textContent=t; document.body.appendChild(el); setTimeout(()=>el.remove(),900); }
function addXP(a){ xp+=a; while(xp>=xpNeed()){ xp-=xpNeed(); level++; playSound(ding); } updateUI(); }

// ---------- save/load ----------
async function saveGame(){
  lastSave=Date.now(); updateUI();
  if(!userId) return;
  await setDoc(doc(db,'users',userId),{money,block,blockScroll,level,xp,upBC,upSC,moneyMult,prestigePoints,prestigeMultiplier,lastUpdated:serverTimestamp(),displayName},{merge:true});
}
async function loadGame(uid){
  if(!uid) return;
  const snap=await getDoc(doc(db,'users',uid)); const d=snap.data()||{};
  money=d.money??0; block=d.block??10; blockScroll=d.blockScroll??1; level=d.level??1; xp=d.xp??0;
  upBC=d.upBC??100; upSC=d.upSC??150; moneyMult=d.moneyMult??1;
  prestigePoints=d.prestigePoints??0; prestigeMultiplier=d.prestigeMultiplier??1;
  displayName=d.displayName??(userEmail.split('@')[0]);
  updateUI();
}

// ---------- login/register ----------
loginBtn.onclick=async()=>{ try{ await signInWithEmailAndPassword(auth,emailI.value,passI.value); }catch(e){ alert('Login failed: '+e.message); } };
registerBtn.onclick=async()=>{ try{ const cred=await createUserWithEmailAndPassword(auth,emailI.value,passI.value); await setDoc(doc(db,'users',cred.user.uid),{money:0,block:10,blockScroll:1,level:1,xp:0,upBC:100,upSC:150,moneyMult:1,prestigePoints:0,prestigeMultiplier:1,displayName:emailI.value.split('@')[0]}); }catch(e){ alert('Register failed: '+e.message); } };
guestBtn.onclick=()=>{ userId=null; userEmail=''; displayName='Guest'; loginScreen.style.display='none'; hud.style.display='block'; centerHUD.style.display='block'; spawnTickLoop(); updateUI(); };

// ---------- logout ----------
logoutBtn.onclick=async()=>{ if(auth.currentUser) await signOut(auth); location.reload(); };

// ---------- upgrades ----------
upBlock.onclick=()=>{ if(money>=upBC){ money-=upBC; block=Math.round(block*1.7); upBC=Math.round(upBC*2.2); playSound(ding); updateUI(); if(userId) saveGame(); }else alert('Not enough money'); };
upScroll.onclick=()=>{ if(money>=upSC){ money-=upSC; blockScroll=Math.round(blockScroll*1.7); upSC=Math.round(upSC*2.4); playSound(ding); updateUI(); if(userId) saveGame(); }else alert('Not enough money'); };

// ---------- prestige ----------
prestigeBtn.onclick=()=>{
  const possible=Math.floor(Math.sqrt(money/10000));
  if(possible<=0){ if(confirm('Rebirth gives prestige points (increase income). Not enough for 1 point. Rebirth anyway?')) doPrestige(0); return; }
  if(confirm(`Rebirth for ${possible} prestige points? (resets money, level, upgrades)`)) doPrestige(possible);
};
function doPrestige(points){
  prestigePoints+=points;
  const maxPoints=Math.floor((20-1)/0.12);
  if(prestigePoints>maxPoints) prestigePoints=maxPoints;
  prestigeMultiplier=1+prestigePoints*0.12;
  money=0; blockScroll=1; block=10; level=1; xp=0; upBC=100; upSC=150; moneyMult=1; upMC=1_000_000;
  playSound(ding); updateUI(); if(userId) saveGame();
}

// ---------- scroll earning ----------
window.addEventListener('wheel',e=>{
  const delta=e.deltaY;
  worldY+=delta*0.5; bgY+=delta*0.6;
  world.style.transform=`translateY(${-worldY}px)`; document.body.style.backgroundPosition=`0px ${bgY}px`;
  if(delta>0){
    const earn=(delta*0.05)*blockScroll*moneyMult*prestigeMultiplier;
    money+=earn;
    addXP(Math.abs(delta)*0.02);
    updateUI();
    if(userId) saveGame();
  }
},{passive:true});

// ---------- spawn tick ----------
let spawnLoopStarted=false;
function spawnTickLoop(){ if(spawnLoopStarted) return; spawnLoopStarted=true; setInterval(()=>{ if(Math.random()<0.07){ const b=document.createElement('div'); b.className='money-block'; b.textContent='ðŸ’°'; const top=Math.random()*(innerHeight-120)+60; const left=Math.random()*(innerWidth-120)+20; b.style.left=left+'px'; b.style.top=top+'px'; world.appendChild(b); b.addEventListener('click',ev=>{ money+=block*moneyMult*prestigeMultiplier; floatText(ev.clientX,ev.clientY,'Â£'+formatNum(block*moneyMult*prestigeMultiplier)); playSound(cash); b.remove(); updateUI(); if(userId) saveGame(); }); setTimeout(()=>{ b.style.opacity='0'; setTimeout(()=>b.remove(),300); },8000); } },1200); }

// ---------- auth state ----------
onAuthStateChanged(auth,u=>{
  if(u){ userId=u.uid; userEmail=u.email||''; displayName=u.displayName||userEmail.split('@')[0]; loginScreen.style.display='none'; hud.style.display='block'; centerHUD.style.display='block'; loadGame(userId); spawnTickLoop(); updateUI(); }
  else{ loginScreen.style.display='flex'; hud.style.display='none'; centerHUD.style.display='none'; }
});

// ---------- initial tick ----------
updateUI();
spawnTickLoop();
</script>
</body>
</html>
