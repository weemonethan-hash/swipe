<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scroll for Money üí∏</title>
<style>
  html,body{margin:0;height:100%;overflow:hidden;font-family:Poppins,sans-serif;color:white;}
  body{
    background:linear-gradient(0deg,#ff66cc,#66ccff,#99ff66,#ff9966);
    background-size:100% 1000%;
    transition:background-position .1s linear;
  }
  #world{position:absolute;width:100%;height:100%;transition:transform .1s linear;}
  #hud{
    position:fixed;top:10px;left:10px;
    background:rgba(20,20,20,.8);border:2px solid #00ff88;border-radius:12px;
    padding:10px 15px;z-index:1000;box-shadow:0 0 15px #00ff88;
  }
  #money{font-size:1.6em;color:#00ff88;text-shadow:0 0 10px #00ff88;font-weight:bold;}
  #xpBar{height:10px;width:100%;background:rgba(255,255,255,.2);border-radius:5px;margin-top:4px;overflow:hidden;}
  #xpFill{height:100%;width:0%;background:linear-gradient(90deg,#00ff88,#00ccff);transition:width .2s;}
  button{
    display:block;margin-top:6px;padding:6px 12px;background:#00ff88;color:#111;
    border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:.2s;
  }
  button:hover{transform:scale(1.05);background:#00cc6a;}
  .money-block{
    position:absolute;font-size:50px;border:3px solid white;border-radius:10px;
    padding:5px 10px;cursor:pointer;transition:transform .2s;user-select:none;
  }
  .fake{border-color:red;}
  .money-block:hover{transform:scale(1.2);}
  .float{
    position:absolute;color:#00ff88;font-weight:bold;pointer-events:none;
    animation:float 1s ease-out forwards;text-shadow:0 0 10px #00ff88;
  }
  @keyframes float{to{transform:translateY(-50px);opacity:0;}}
  #loginScreen{position:absolute;top:0;left:0;width:100%;height:100%;background:#111d;color:white;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:2000;}
  #loginScreen input{margin:5px;padding:6px;width:200px;border-radius:6px;border:none;}
</style>
<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDj5-jNLG4Ampuc56ygFA8kXScbuVFctBk",
    authDomain: "scroll-3f622.firebaseapp.com",
    projectId: "scroll-3f622",
    storageBucket: "scroll-3f622.firebasestorage.app",
    messagingSenderId: "1012742622451",
    appId: "1:1012742622451:web:e217b4a775975911d93b86"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  window.firebaseFns = { auth, db, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, doc, setDoc, getDoc };
</script>
</head>
<body>

<div id="loginScreen">
  <h2>Login / Register</h2>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <button id="loginBtn">Login</button>
  <button id="registerBtn">Register</button>
</div>

<div id="hud" style="display:none;">
  üí∞ <span id="money">0</span><br>
  ‚≠ê Level: <span id="level">1</span>
  <div id="xpBar"><div id="xpFill"></div></div>
  <div>‚¨ÜÔ∏è Scroll: <span id="scrollIncome">1</span></div>
  <div>üß± Block: <span id="blockValue">10</span></div>
  <button id="upB">Upgrade Block üíé (100)</button>
  <button id="upS">Upgrade Scroll üöÄ (150)</button>
  <button id="autoScrollBtn">üåÄ Auto Scroll: OFF</button>
  <div id="skins">
    <h3>Skins</h3>
    <div>
      Background: <button id="bgSkin1">Default</button>
      <button id="bgSkin2">Neon üåå (Cost: 124313, Level: 4)</button>
    </div>
    <div>
      Money Block: <button id="blockSkin1">Default</button>
      <button id="blockSkin2">Gold üí∞ (Cost: 200000, Level: 5)</button>
    </div>
  </div>
  <button id="dailyBonusBtn">Claim Daily Bonus</button>
  <button id="resetBtn" style="margin-top:5px;">Reset Account</button>
</div>

<div id="world"></div>
<audio id="ding" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>

<script type="module">
import { auth, db, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
import { doc as docRef, setDoc as setDocFn, getDoc as getDocFn } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore.js";

const loginScreen = document.getElementById("loginScreen");
const hud = document.getElementById("hud");
const emailInput = document.getElementById("email");
const passwordInput = document.getElementById("password");

let money=0, blockScroll=1, block=10, level=1, xp=0;
let upBC=100, upSC=150, worldY=0, bgY=0, auto=false;
let currentBG="bg1", currentBlock="block1";

const world=document.getElementById("world"), ding=document.getElementById("ding");
const mD=document.getElementById("money"),lD=document.getElementById("level"),
sD=document.getElementById("scrollIncome"),bD=document.getElementById("blockValue"),xpF=document.getElementById("xpFill");
const autoBtn=document.getElementById("autoScrollBtn");

function xpNeed(){return 100*Math.pow(1.6,level-1);}
function upd(){mD.textContent=Math.floor(money);lD.textContent=level;sD.textContent=blockScroll;bD.textContent=block;xpF.style.width=(xp/xpNeed()*100)+"%";}
function sound(){ding.currentTime=0;ding.play().catch(()=>{});}
function float(x,y,t,color="#00ff88"){let f=document.createElement("div");f.className="float";f.style.left=x+"px";f.style.top=y+"px";f.style.color=color;f.textContent=t;document.body.appendChild(f);setTimeout(()=>f.remove(),1000);}
function addXP(a){xp+=a;if(xp>=xpNeed()){xp-=xpNeed();level++;sound();}}
function saveGame(uid){if(!uid) return; setDoc(doc(db,"users",uid),{money,blockScroll,block,level,xp,currentBG,currentBlock},{merge:true});}

document.getElementById("loginBtn").onclick=async ()=>{
  const email=emailInput.value,password=passwordInput.value;
  try{
    await signInWithEmailAndPassword(auth,email,password);
  }catch(e){alert("Login failed: "+e.message);}
};

document.getElementById("registerBtn").onclick=async ()=>{
  const email=emailInput.value,password=passwordInput.value;
  try{
    const userCred = await createUserWithEmailAndPassword(auth,email,password);
    await setDoc(doc(db,"users",userCred.user.uid),{money:0,blockScroll:1,block:10,level:1,xp:0,currentBG:"bg1",currentBlock:"block1"});
  }catch(e){alert("Register failed: "+e.message);}
};

onAuthStateChanged(auth, async (user)=>{
  if(user){
    loginScreen.style.display="none";
    hud.style.display="block";
    const snap = await getDoc(doc(db,"users",user.uid));
    const data = snap.data();
    money=data?.money||0; blockScroll=data?.blockScroll||1; block=data?.block||10; level=data?.level||1; xp=data?.xp||0;
    currentBG=data?.currentBG||"bg1"; currentBlock=data?.currentBlock||"block1";
    if(currentBG==="bg1") document.body.style.background="linear-gradient(0deg,#ff66cc,#66ccff,#99ff66,#ff9966)";
    else document.body.style.background="linear-gradient(45deg, #ff00ff, #00ffff, #ffff00, #ff6600)";
    upd();
  }else{
    loginScreen.style.display="flex";
    hud.style.display="none";
  }
});

// Scroll and spawn
window.addEventListener("wheel",e=>{
  const delta=e.deltaY;
  worldY+=delta*0.5; bgY+=delta*0.5;
  world.style.transform=`translateY(${-worldY}px)`;document.body.style.backgroundPosition=`0px ${bgY}px`;
  if(delta>0){ const earn=delta*blockScroll*0.05; money+=earn; addXP(delta*0.02); if(Math.random()<0.06) spawnBlock(); upd(); saveGame(auth.currentUser?.uid); }
});

function spawnBlock(){
  const b=document.createElement("div"); b.className="money-block";
  const fake=Math.random()<0.25; if(fake)b.classList.add("fake");
  b.textContent="üí∞"; if(currentBlock==="block2") b.textContent="üü®";
  b.style.top=worldY+Math.random()*innerHeight-innerHeight/2+"px";
  b.style.left=Math.random()*(innerWidth-100)+"px";
  world.appendChild(b);
  b.onclick=e=>{
    if(fake){ const loss=Math.ceil(level*0.5); level=Math.max(1,level-loss); xp=0; float(e.clientX,e.clientY,`-${loss} LVL`,"red"); b.remove(); }
    else { money+=block; float(e.clientX,e.clientY,"+"+block); sound(); b.remove(); }
    upd(); saveGame(auth.currentUser?.uid);
  };
  setTimeout(()=>b.remove(),8000);
}

// Upgrades
document.getElementById("upB").onclick=()=>{
  if(money>=upBC){money-=upBC;block=Math.round(block*1.7);upBC=Math.round(upBC*2.2);
    event.target.textContent=`Upgrade Block üíé (${upBC})`;sound();upd();saveGame(auth.currentUser?.uid);}
};
document.getElementById("upS").onclick=()=>{
  if(money>=upSC){money-=upSC;blockScroll=Math.round(blockScroll*1.8);upSC=Math.round(upSC*2.4);
    event.target.textContent=`Upgrade Scroll üöÄ (${upSC})`;sound();upd();saveGame(auth.currentUser?.uid);}
};

// Auto scroll
autoBtn.onclick=()=>{ auto=!auto; autoBtn.textContent=auto?"üåÄ Auto Scroll: ON":"üåÄ Auto Scroll: OFF"; };
setInterval(()=>{ if(auto){ const delta=8; worldY+=delta*0.5; bgY+=delta*0.5; world.style.transform=`translateY(${-worldY}px)`;document.body.style.backgroundPosition=`0px ${bgY}px`; const earn=delta*blockScroll*0.05*0.12; money+=earn; if(Math.random()<0.03)spawnBlock(); upd(); saveGame(auth.currentUser?.uid); } },100);

// Skins
document.getElementById("bgSkin1").onclick = () => { currentBG="bg1"; document.body.style.background="linear-gradient(0deg,#ff66cc,#66ccff,#99ff66,#ff9966)"; saveGame(auth.currentUser?.uid); };
document.getElementById("bgSkin2").onclick = () => { if(level>=4 && money>=124313){ money-=124313; currentBG="bg2"; document.body.style.background="linear-gradient(45deg, #ff00ff, #00ffff, #ffff00, #ff6600)"; upd(); saveGame(auth.currentUser?.uid); } else alert("Need Level 4 & ¬£124313"); };
document.getElementById("blockSkin1").onclick = () => { currentBlock="block1"; saveGame(auth.currentUser?.uid); };
document.getElementById("blockSkin2").onclick = () => { if(level>=5 && money>=200000){ money-=200000; currentBlock="block2"; upd(); saveGame(auth.currentUser?.uid); } else alert("Need Level 5 & ¬£200000"); };

// Daily bonus
document.getElementById("dailyBonusBtn").onclick = async () => {
  const user = auth.currentUser; if(!user) return;
  const today = new Date().toDateString();
  const snap = await getDoc(doc(db,"users",user.uid));
  const lastClaim = snap.data()?.lastDaily || "";
  if(lastClaim===today){ alert("Already claimed today!"); return; }
  money+=5000; upd();
  await setDoc(doc(db,"users",user.uid),{...snap.data(), lastDaily: today, money},{merge:true});
  alert("Daily bonus claimed: ¬£5000!");
};

// Reset account
document.getElementById("resetBtn").onclick = async () => {
  const user = auth.currentUser; if(!user) return;
  if(confirm("Reset account? This cannot be undone!")){
    await setDoc(doc(db,"users",user.uid),{money:0,blockScroll:1,block:10,level:1,xp:0,currentBG:"bg1",currentBlock:"block1"},{merge:true});
    money=0; blockScroll=1; block=10; level=1; xp=0; currentBG="bg1"; currentBlock="block1";
    document.body.style.background="linear-gradient(0deg,#ff66cc,#66ccff,#99ff66,#ff9966)"; upd();
    alert("Account reset!");
  }
};

upd();
</script>
</body>
</html>
